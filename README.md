Утилиты
===========
##### Автор: Кудряшова Анастасия (группа 191-321)

Утилиты. Каким образом в composer можно сымитировать зависимости платформы на которой выполняются команды. Каким образом можно обойти зависимости платформы. Каким образом в Makefile можно защититься от выполнения файла при передаче аргумента команде make. 

1. [Имитация зависимостей в composer](#One)
2. [Способ обойти зависимости](#Two)
3. [Защита Makefile от выполнения файла при передаче аргумента](#Three)
4. [Источники](#Four)


### <a name="One"></a>	Каким образом в composer можно сымитировать зависимости платформы на которой выполняются команды?

Подсекция platform секции config манифеста composer.json позволяет эмулировать (обманывать) требования пакетов к среде выполнения (например, интерпретатору php и его расширений).
Пример:

```sh
"config": {
        "platform": {
            "php": "5.5.8"
        }
    },
```
В данном примере подсекция platform заставит все пакеты считать, что в нашей системе установлена версия php = 5.5.8, хотя в реальности будет использовать реальный интерпретатор.

Можно указывать версии и других php-расширений, если вам надо соответствовать, допустим, конфигурации сервера, на котором вы не работаете, и не можете ставить себе такое же окружение.
Пример:

```sh
"config": {
 {"php": "7.0.3", "ext-something": "2.0"}
}
```
В примере выше, помимо версии интерпретатора, указана версия something, то есть если в вашей системе обе эти версии отличаются от указанных в секции, то composer всё равно будет ориентироваться на указнные в ней, а не на фактические.

Однако это также означает, что зависимости больше не проверяются правильно.Если вы, допустим, запустите PHP версии 5.6, он установится нормально, как предполагается 7.0.3, но затем он выйдет из строя во время эксплуатации.

### <a name="Two"></a>  Каким образом можно обойти зависимости платформы?

Если для зависимости требуется какое-либо расширение, которое вы не установили локально, вы можете проигнорировать его, передав --ignore-platform-req=ext-foo как флаг для команд update, install или require. 
Например:

```sh
compоser install --ignore-platform-reqs
```

В долгосрочной перспективе вы можете неосознанно создать проблемы в производстве. Будьте внимательнее.

### <a name="Three"></a>    Каким образом в Makefile можно защититься от выполнения файла при передаче аргумента команде make?

Допустим, мы хотим 
Некоторые методы «передачи аргументов для запуска»:
```sh
run: prog
    ./prog $(filter-out $@, $(MAKECMDGOALS))

%:
    @true
```
Здесь нам нужно отфильтровать текущую цель из списка целей. create catch all target ( %), который ничего не делает, чтобы молча игнорировать другие цели.

```sh
ifeq (run, $(firstword $(MAKECMDGOALS)))
  runargs := $(wordlist 2, $(words $(MAKECMDGOALS)), $(MAKECMDGOALS))
  $(eval $(runargs):;@true)
endif

run:
    ./prog $(runargs)
```
если цель - runудалить первую цель и создать ничего не делать цели для оставшихся целей, используя eval.

оба способа позволят вам написать что-то вроде этого

```sh
$ make run arg1 arg2
```

### <a name="Four"></a>    Список источников

+ <https://getcomposer.org/doc/06-config.md#platform>
+ <http://fkn.ktu10.com/?q=node/9866>
+ <http://fkn.ktu10.com/?q=node/8594>
+ <http://linux.yaroslavl.ru/docs/prog/gnu_make_3-79_russian_manual.html>

